<!DOCTYPE html>
<html lang="it">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Design System</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="styles/variables.css" />
    <link rel="stylesheet" href="styles/base.css" />
    <link rel="stylesheet" href="styles/typography.css" />
    <link rel="stylesheet" href="components/link/link.css" />
    <style>
      /* Reset body padding per layout full-width */
      body {
        padding: 0;
        margin: 0;
        display: grid;
        grid-template-columns: auto 1fr;
        height: 100vh;
        overflow: hidden;
      }

      /* Sidebar */
      .sidebar {
        background-color: var(--grey-100);
        padding: var(--spacing-xl);
        overflow-y: auto;
        border-right: 1px solid var(--grey-300);
      }

      /* Sidebar headings */
      .sidebar-heading {
        margin: 0 0 var(--spacing-m) 0;
      }

      .sidebar-heading:not(:first-child) {
        margin-top: var(--spacing-xxxl);
      }

      /* Page list */
      .page-list {
        list-style: none;
        padding: 0;
        margin: 0;
      }

      .page-list__item {
        margin-bottom: var(--spacing-m);
      }

      .page-list__link {
        display: block;
        /* font-size: var(--font-size-sm); */
      }

      /* Content area */
      .content {
        position: relative;
        overflow: hidden;
      }

      /* Iframe */
      .content-frame {
        width: 100%;
        height: 100%;
        border: none;
        display: block;
      }

      /* Placeholder quando nessun contenuto Ã¨ caricato */
      .content-placeholder {
        display: flex;
        align-items: center;
        justify-content: center;
        height: 100%;
        color: var(--grey-600);
        font-size: 16px;
      }
    </style>
  </head>
  <body>
    <!-- Sidebar -->
    <aside class="sidebar">
      <ul class="page-list">
        <li class="page-list__item">
          <a href="index.html" class="page-list__link link">home</a>
        </li>
      </ul>

      <p class="sidebar-heading title title--sm title--uppercase">Reference</p>
      <ul class="page-list">
        <li class="page-list__item">
          <a
            href="reference/colors.html"
            class="page-list__link link"
            data-target="iframe"
            >colors</a
          >
        </li>
        <li class="page-list__item">
          <a
            href="reference/icons.html"
            class="page-list__link link"
            data-target="iframe"
            >icons</a
          >
        </li>
        <li class="page-list__item">
          <a
            href="reference/typography.html"
            class="page-list__link link"
            data-target="iframe"
            >typography</a
          >
        </li>
      </ul>

      <p class="sidebar-heading title title--sm title--uppercase">Components</p>
      <ul class="page-list">
        <li class="page-list__item">
          <a
            href="components/badge/demo.html"
            class="page-list__link link"
            data-target="iframe"
            >badge</a
          >
        </li>
        <li class="page-list__item">
          <a
            href="components/blockquote/demo.html"
            class="page-list__link link"
            data-target="iframe"
            >blockquote</a
          >
        </li>
        <li class="page-list__item">
          <a
            href="components/button/demo.html"
            class="page-list__link link"
            data-target="iframe"
            >button</a
          >
        </li>
        <li class="page-list__item">
          <a
            href="components/checkbox/demo.html"
            class="page-list__link link"
            data-target="iframe"
            >checkbox</a
          >
        </li>
        <li class="page-list__item">
          <a
            href="components/dropdown/demo.html"
            class="page-list__link link"
            data-target="iframe"
            >dropdown</a
          >
        </li>
        <li class="page-list__item">
          <a
            href="components/header/demo.html"
            class="page-list__link link"
            data-target="iframe"
            >header</a
          >
        </li>
        <li class="page-list__item">
          <a
            href="components/input/demo.html"
            class="page-list__link link"
            data-target="iframe"
            >input</a
          >
        </li>
        <li class="page-list__item">
          <a
            href="components/link/demo.html"
            class="page-list__link link"
            data-target="iframe"
            >link</a
          >
        </li>
        <li class="page-list__item">
          <a
            href="components/logo/demo.html"
            class="page-list__link link"
            data-target="iframe"
            >logo</a
          >
        </li>
        <li class="page-list__item">
          <a
            href="components/search-bar/demo.html"
            class="page-list__link link"
            data-target="iframe"
            >search-bar</a
          >
        </li>
        <li class="page-list__item">
          <a
            href="components/tabs/demo.html"
            class="page-list__link link"
            data-target="iframe"
            >tabs</a
          >
        </li>
        <li class="page-list__item">
          <a
            href="components/textarea/demo.html"
            class="page-list__link link"
            data-target="iframe"
            >textarea</a
          >
        </li>
        <li class="page-list__item">
          <a
            href="components/tree-node/demo.html"
            class="page-list__link link"
            data-target="iframe"
            >tree-node</a
          >
        </li>
      </ul>
    </aside>

    <!-- Content area con iframe -->
    <main class="content">
      <div class="content-placeholder">
        Seleziona un elemento dalla sidebar per visualizzarlo
      </div>
      <iframe
        id="content-frame"
        class="content-frame"
        style="display: none"
      ></iframe>
    </main>

    <script src="https://unpkg.com/rough-notation/lib/rough-notation.iife.js"></script>
    <script>
      // Gestione click sui link per caricare nell'iframe
      document.addEventListener("DOMContentLoaded", function () {
        const iframe = document.getElementById("content-frame");
        const placeholder = document.querySelector(".content-placeholder");
        const sidebarLinks = document.querySelectorAll(
          '.page-list__link[data-target="iframe"]'
        );

        let currentAnnotation = null;

        sidebarLinks.forEach((link) => {
          link.addEventListener("click", function (e) {
            const url = this.getAttribute("href");

            // Cmd/Ctrl+Click = apri in nuovo tab (standalone, senza embedded)
            if (e.metaKey || e.ctrlKey) {
              window.open(url, "_blank");
              return;
            }

            e.preventDefault();

            // Rimuovi annotation precedente
            if (currentAnnotation) {
              currentAnnotation.hide();
              currentAnnotation.remove();
            }

            // Aggiungi box notation al link selezionato
            currentAnnotation = RoughNotation.annotate(this, {
              type: "box",
              color: getComputedStyle(document.documentElement)
                .getPropertyValue("--pink-300")
                .trim(),
              strokeWidth: 2,
              animate: false,
            });
            currentAnnotation.show();

            // Mostra iframe, nascondi placeholder
            placeholder.style.display = "none";
            iframe.style.display = "block";

            // Carica contenuto nell'iframe con parametro embedded=true
            const embeddedUrl =
              url + (url.includes("?") ? "&" : "?") + "embedded=true";
            iframe.src = embeddedUrl;
          });
        });
      });
    </script>
  </body>
</html>
